<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OrdenLista | Cocina y Seguimiento</title>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" />
  <link rel="stylesheet" href="css/app.css" />
  
  <style>
    /* Estilos espec√≠ficos para la tabla de √≥rdenes */
    .tabla-ordenes { margin-top: 1rem; font-size: 0.9rem; }
    .tabla-ordenes td { vertical-align: middle; }
    
    /* Etiquetas de Estado */
    .estado-pendiente { background-color: #c0392b; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.75rem; }
    .estado-proceso { background-color: #2980b9; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.75rem; }
    .estado-terminado { background-color: #27ae60; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.75rem; }
    
    /* Alerta de tiempo */
    .tiempo-alerta-rojo { color: #d63031; font-weight: 800; animation: parpadeo 1.5s infinite; }
    @keyframes parpadeo { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

    /* Modal Ticket */
    #modalTicket { backdrop-filter: blur(5px); }

    @media print {
      body * { visibility: hidden; }
      #modalTicket, #modalTicket * { visibility: visible; }
      #modalTicket { position: absolute; left: 0; top: 0; width: 100%; height: auto; background: white; display: block !important; }
      .no-print { display: none !important; }
    }
  </style>
</head>
<body>
  <audio id="audioNotificacion" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

  <nav class="container-fluid nav-inicio">
    <ul><li><strong>‚òï OrdenLista - Cocina</strong></li></ul>
    <ul id="menuNavegacion" class="nav-botones"></ul>
  </nav>

  <main class="container-fluid" style="padding: 20px;">
    <div class="grid">
      <div>
        <hgroup>
            <h1>Monitor de Cocina</h1>
            <h2>Gestiona las √≥rdenes entrantes</h2>
        </hgroup>
      </div>
      
      <div style="display:flex; gap:10px; align-items:center; justify-content:flex-end;">
        <select id="filtroEstado" style="max-width:200px;">
            <option value="todos">üëÅÔ∏è Ver Todo</option>
            <option value="por_confirmar">üîî QR Solicitudes</option>
            <option value="pendiente" selected>üî• Pendientes</option>
            <option value="proceso">üë®‚Äçüç≥ En Proceso</option>
            <option value="terminado">‚úÖ Listos</option>
        </select>
        <input type="search" id="inputBusqueda" placeholder="Buscar mesa o ID..." style="max-width:250px;" />
      </div>
    </div>

    <figure>
      <table role="grid" class="tabla-ordenes">
        <thead>
          <tr>
            <th>ID</th>
            <th>Mesa</th>
            <th>Detalle del Pedido</th>
            <th>Total</th>
            <th>Estado</th>
            <th>Tiempo</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tablaBodyOrdenes">
           <tr><td colspan="7" class="text-center">Cargando √≥rdenes...</td></tr>
        </tbody>
      </table>
    </figure>
  </main>

  <div id="modalTicket" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:white; padding:20px; width:100%; max-width:350px; border-radius:8px; box-shadow:0 10px 25px rgba(0,0,0,0.5);">
      
      <div style="text-align:center; border-bottom:2px dashed #333; padding-bottom:10px; margin-bottom:10px;">
        <h3>COMANDA</h3>
        <p style="margin:0; font-size:0.9rem;">Folio: #<span id="t-folio"></span></p>
        <p style="margin:0; font-size:0.9rem;">Mesa: <span id="t-mesa" style="font-weight:bold;"></span></p>
        <small id="t-fecha" style="color:#666;"></small>
      </div>

      <table style="width:100%; border-collapse:collapse; font-size:0.9rem;">
        <tbody id="t-items"></tbody>
      </table>

      <div style="margin-top:15px; border-top:2px dashed #333; padding-top:10px; text-align:right;">
        <strong style="font-size:1.2rem;">Total: $<span id="t-total"></span></strong>
      </div>

      <div class="grid no-print" style="margin-top:20px; gap:10px;">
        <button onclick="window.print()" class="primary">üñ®Ô∏è Imprimir</button>
        <button onclick="document.getElementById('modalTicket').style.display='none'" class="secondary outline">Cerrar</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/supabase-client.js"></script> <script src="js/app.js"></script>             <script src="js/ordenes.js"></script>         </body>
</html>